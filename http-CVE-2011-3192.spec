Summary: Repository hrb release file and package configuration
Name: http-CVE-2011-3192
Version: 0.1
Release: 1%{?dist}
License: GPL
Group: System Environment/Base
URL: http://www.hrbac.cz/repository.htm
BuildArch:    noarch

BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root

%description
Workaround to address CVE-2011-3192.
Drop the Range header when more than 5 ranges.

%prep

%{__cat} <<EOF > CVE-2011-3192.conf
# Drop the Range header when more than 5 ranges.
# CVE-2011-3192

<IfModule mod_setenvif.c>
    SetEnvIf Range (,.*?){5,} bad-range=1
    RequestHeader unset Range
</IfModule>
EOF

%install
%{__rm} -rf %{buildroot}
%{__install} -Dp -m0644 CVE-2011-3192.conf %{buildroot}%{_sysconfdir}/httpd/conf.d/CVE-2011-3192.conf

%clean
%{__rm} -rf %{buildroot}

%post

%files
%defattr(-, root, root, 0755)
%dir %{_sysconfdir}/httpd/conf.d/
%config(noreplace) %{_sysconfdir}/httpd/conf.d/CVE-2011-3192.conf

%changelog
* Fri Aug 26 2011 David Hrbáč <david@hrbac.cz> - 0.1-1
- Initial package. 
